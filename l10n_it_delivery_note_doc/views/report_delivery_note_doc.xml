<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>

        <template id="delivery_note_doc_report_template">
            <t t-call="web.external_layout">
                <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)" />
                <t t-set="address">
                    <h4>
                        <strong>Delivery address:</strong>
                    </h4>
                    <address
                        t-field="doc.partner_id"
                        t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'
                    />
                    <div t-if="doc.partner_id.vat" class="mt16">
                        <t
                            t-if="doc.company_id.country_id.vat_label"
                            t-esc="doc.company_id.country_id.vat_label"
                            id="inv_tax_id_label"
                        />
                        <t t-else="">Tax ID</t>: <span
                            t-field="doc.partner_id.vat"
                        /></div>
                </t>
                <div class="page">
                    <div id="dn_terms">
                        <strong> Delivery Note: </strong>
                        Under the terms of Italian Presidential Decree 472-96 of 14.08.1996
                    </div>

                    <h2 id="document_title">
                        <t t-if="doc.ddt_number">
                            <span>DDT number:</span>
                            <small>
                                <span t-field="doc.ddt_number" name="ddt_number" />
                            </small>
                            <span t-if="doc.date_ddt"> of: </span>
                            <small>
                                <span t-field="doc.date_ddt" />
                            </small>
                        </t>
                        <t t-else="">
                            <span>DDT Draft - of :</span>
                            <span t-field="doc.date_ddt" />
                        </t>
                    </h2>

                    <div id="delivery_data_information" class="row mt32 mb32">
                        <div t-if="doc.transport_reason_id" class="col-3 bm-2">
                            <strong>Reason of Transport:</strong>
                            <p t-field="doc.transport_reason_id" class="m-0" />
                        </div>
                        <div t-if="doc.transport_condition_id" class="col-3 bm-2">
                            <strong>Carriage Condition:</strong>
                            <p t-field="doc.transport_condition_id" class="m-0" />
                        </div>
                        <div t-if="doc.transport_method_id" class="col-3 bm-2">
                            <strong>Method of Transport:</strong>
                            <p t-field="doc.transport_method_id" class="m-0" />
                        </div>
                    </div>

                    <table
                        id="product_data"
                        class="mt32 mb32 o_main_table table table-sm"
                    >
                        <thead>
                            <tr>
                                <th class="text-left">Description</th>
                                <th class="text-right">Quantity</th>
                            </tr>
                        </thead>
                        <tbody class="sale_tbody">
                            <t t-foreach="doc.line_ids" t-as="line">
                                <tr>
                                    <td>
                                        <span t-field="line.name" />
                                    </td>
                                    <td class="text-right">
                                        <span t-field="line.quantity" />
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                    <table
                        id="parcel_info"
                        class="table table-condensed table-bordered delivery_data"
                        style="page-break-inside: avoid"
                    >
                        <tr>
                            <td>
                                <div
                                    name="good_description"
                                    style="font-size:10px;"
                                >Goods Description</div>
                                <div
                                    style="font-size:12px;"
                                    t-field="doc.goods_appearance_id"
                                />
                            </td>
                            <td>
                                <div
                                    name="gross_weight"
                                    style="font-size:10px;"
                                >Gross Weight</div>
                                <div
                                    class="text-right"
                                    style="font-size:12px;"
                                    t-field="doc.gross_weight"
                                />
                            </td>
                            <td>
                                <div
                                    name="net_weight"
                                    style="font-size:10px;"
                                >Net Weight</div>
                                <div
                                    class="text-right"
                                    style="font-size:12px;"
                                    t-field="doc.net_weight"
                                />
                            </td>
                            <td>
                                <div
                                    name="transport_date"
                                    style="font-size:10px;"
                                >DN date</div>
                                <div
                                    class="m-0"
                                    style="font-size:12px;"
                                    t-field="doc.date_transport_ddt"
                                />
                            </td>
                            <td>
                                <div
                                    name="packages"
                                    style="font-size:10px;"
                                >Packages</div>
                                <div
                                    class="text-right"
                                    style="font-size:12px;"
                                    t-field="doc.packages"
                                />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="5" class="notes">
                                <div name="notes" style="font-size:10px;">Notes</div>
                                <br />
                                <div style="font-size:12px;" t-field="doc.ddt_notes" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="5">
                                <table class="table table-condensed delivery_data">
                                    <tr>
                                        <td>
                                            <div
                                                name="carrier_signature"
                                                style="font-size:10px;"
                                            >Carrier's Signature</div>
                                            <br />
                                        </td>
                                        <td>
                                            <div
                                                name="driver_signature"
                                                style="font-size:10px;"
                                            >Driver's Signature</div>
                                            <br />
                                        </td>
                                        <td>
                                            <div
                                                name="recipint_signature"
                                                style="font-size:10px;"
                                            >Recipient's Signature</div>
                                            <br />
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                    <div class="oe_structure" />
                </div>
            </t>
        </template>

        <template id="report_delivery_note_doc_main_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t
                        t-call="l10n_it_delivery_note_doc.delivery_note_doc_report_template"
                        t-lang="doc.partner_id.lang"
                    />
                </t>
            </t>
        </template>


        <record id="action_report_delivery_note_doc" model="ir.actions.report">
            <field name="name">Delivery Note Document</field>
            <field name="model">delivery.note.doc</field>
            <field name="report_type">qweb-pdf</field>
            <field
                name="report_name"
            >l10n_it_delivery_note_doc.report_delivery_note_doc_main_template</field>
            <field
                name="report_file"
            >l10n_it_delivery_note_doc.report_delivery_note_doc_main_template</field>
            <field
                name="print_report_name"
            >'Delivery Note - %s' % object.ddt_number</field>
            <field name="binding_model_id" ref="model_delivery_note_doc" />
            <field name="binding_type">report</field>
        </record>

    </data>
</odoo>
